<html>
<body>
<a href="index.html">[↑TOP]</a>
<br>
<hr size="0">
<h3>pg_float_recipro : 浮動小数点型 符号付 逆数</h3>
<hr size="0">

<!------------------------------------>
<h4>書式</h4>

pg_float_recipro(<i>x</i>, <i>z</i>,   <i>NFLO</i>, <i>NMAN</i>, <i>NST</i>);<br>

<hr size="0">


<!------------------------------------>
<h4>引数</h4>

<br>

  <dl compact="compact">
  <dt><i>x</i></dt>
  <dd>  :  入力値  </dd>

  <dt><i>z</i></dt>
  <dd>  :  演算結果 : 入力の逆数  </dd>

  <dt><i>NFLO</i></dt>
  <dd>  : 浮動小数点ワードビット幅 </dd>

  <dt><i>NMAN</i></dt>
  <dd>  :  仮数部(精度)ビット幅</dd>

  <dt><i>NST</i></dt>
  <dd>  :  パイプラインステージ数</dd>

  </dl>

<hr size="0">

<!------------------------------------>
<h4>記述例</h4>
<pre>
pg_float_recipro(x, z, 19,  9, 3);
pg_float_recipro(x, z, 26, 16, 3);
pg_float_recipro(x, z, 33, 23, 3);
</pre>

<hr size="0">

<!------------------------------------>
<h4>概要</h4>
  z = 1.0/x;<br><br>
  つまり, 入力の逆数を計算する.<br>
  <br>
  <br>
  (注) 仮数部9ビット以下は1st Interpolationにしなければなりませんが
  強引に2nd Interpolationにしています.<br>
  そんなわけで, 仮数部9ビット以下はちょっと奇妙な回路構成になっています.
  (仮数部8ビットより9ビットの方が回路効率が良かったりとか).<br>
  仮数部9ビット以下での1st Interpolationのサポートはバージョンアップの時にということでお許しください.
<br>
  (注) 2nd Interpolation はぎりぎり単精度程度(Nman=21付近)しか精度が出せませんのであしからず.

<hr size="0">
<h4>パイプラインマップ (NMAN21を境に切り替え)</h4>
<pre>
NMAN 21 以下
NST 1 : 1[-], 2[-], 3[-], 4[-], 5[-], 6[-], 7[-], 8[O]
NST 2 : 1[-], 2[O], 3[-], 4[-], 5[-], 6[-], 7[-], 8[O]
NST 3 : 1[-], 2[O], 3[-], 4[O], 5[-], 6[-], 7[-], 8[O]
NST 4 : 1[O], 2[O], 3[-], 4[O], 5[-], 6[-], 7[-], 8[O]
NST 5 : 1[O], 2[O], 3[O], 4[O], 5[-], 6[-], 7[-], 8[O]

NMAN 22 以上
NST 1 : 1[-], 2[-], 3[-], 4[-], 5[-], 6[-], 7[-], 8[O]
NST 2 : 1[-], 2[O], 3[-], 4[-], 5[-], 6[-], 7[-], 8[O]
NST 3 : 1[O], 2[O], 3[-], 4[-], 5[-], 6[-], 7[-], 8[O]
NST 4 : 1[O], 2[O], 3[-], 4[O], 5[-], 6[-], 7[-], 8[O]
NST 5 : 1[O], 2[O], 3[O], 4[O], 5[-], 6[-], 7[-], 8[O]
</pre>


<hr size="0">

<h4>性能(Xilinx Virtex-II PRO XC2VP70-5FF1517C)</h4>

<pre>
----------------------------------------------------------------------------------------
pg_float_recipro(x, z, 19,  9, NST);
NFLO=19
NMAN= 9
NST,    MHz , Cpath, Slices,  FFs,  LUTs, MULT18X18
1  , 102.020,  0-8 ,     43,   19,    74,       1
2  , 123,625,  2-8 ,     48,   42,    84,       2
3  , 172.801,  2-4 ,     54,   70,    84,       2
4* , 172.801,  2-4 ,     76,  109,    84,       2
5  , 240.558,  4-8 ,     71,   76,   105,       2

(* : not efficient)
----------------------------------------------------------------------------------------
pg_float_recipro(x, z, 26, 16, NST);
NFLO=26
NMAN=16
NST,    MHz , Cpath, Slices,  FFs,  LUTs, MULT18X18
1  ,  59.485,  0-8 ,     75,   26,   131,       5
2  , 111.769,  2-8 ,     83,   54,   148,       5
3  , 125.834,  0-1 ,     86,   96,   148,       5
4  , 150.489,  2-4 ,    126,  172,   148,       5
5  , 206.526,  2-3 ,    112,  140,   176,       5

----------------------------------------------------------------------------------------
pg_float_recipro(x, z, 33, 23, NST);
NFLO=33
NMAN=23
NST,    MHz , Cpath, Slices,  FFs,  LUTs, MULT18X18
1  ,  42.648,  0-8 ,    146,   33,   263,      10
2  ,  73.828,  0-2 ,    159,   68,   291,      10
3  ,  86.237,  2-8 ,    203,  172,   314,      10
4  , 104.998,  2-4 ,    223,  245,   314,      10
5  , 140.371,  3-4 ,    221,  259,   349,      10
</pre>

<hr size="0">
<h4>演算精度 |Erel|max</h4>

<!--
<pre>
Nflo, Nman, Ncut, |Erel|max
18  ,    8,    5,  3.6e-3
19  ,    9,    5,  3.6e-3
20  ,   10,    6,  1.9e-3
21  ,   11,    7,  9.4e-4
22  ,   12,    8,  4.8e-4
23  ,   13,    9,  2.4e-4
24  ,   14,   10,  1.3e-4
25  ,   15,   11,  6.9e-5
26  ,   16,   12,  3.4e-5
27  ,   17,   13,  2.1e-5
28  ,   18,   14,  1.5e-5
29  ,   19,   15,  1.1e-5
30  ,   20,   16,  8.7e-6
31  ,   21,   17,  7.9e-6
32  ,   22,   18,  7.4e-6
33  ,   23,   19,  7.2e-6
(区間幅Ncutの再調整が必要かもしれない)
</pre>
-->


<ul>
<li>
    <h3>pg_float_recipro(x, z, 20, 10, NST);</h3>
    <h3>|Erel|max = 1.9e-3</h3>
    <a href="./img/pg_float_recipro_20_10.png">
    <img src="./img/pg_float_recipro_20_10.png" width="300">
    </a>
<li>
    <h3>pg_float_recipro(x, z, 26, 16, NST);</h3>
    <h3>|Erel|max = 3.4e-5</h3>
    <a href="./img/pg_float_recipro_26_16.png">
    <img src="./img/pg_float_recipro_26_16.png" width="300">
    </a>
<li>
    <h3>pg_float_recipro(x, z, 33, 23, NST);</h3>
    <h3>|Erel|max = 7.2e-6</h3>
    <a href="./img/pg_float_recipro_33_23.png">
    <img src="./img/pg_float_recipro_33_23.png" width="300">
    </a>
</ul>


<hr size="0">

<!------------------------------------>
<h4>参照</h4>

<hr size="0">
<I>Change Log</I>
<ul>
<li> 2004.10.17 : 単精度のパイプライニング努力. 乗算器4分割対応. 一応格好つけたつもり.
<li> 2004.10.14 : まだまだちっさくできるはずだけど...
<li> 2004.10.12 : the first edition by T. Hamada
</ul>

</body>
</html>
